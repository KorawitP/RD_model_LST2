# 3.6 การแปลผลและอธิบายแบบจำลอง (Model Interpretation)

หนึ่งในความท้าทายสำคัญของการใช้แบบจำลองการเรียนรู้ของเครื่องขั้นสูง (Advanced Machine Learning) และการเรียนรู้เชิงลึก (Deep Learning) คือลักษณะความเป็น "กล่องดำ" (Black-box) ซึ่งยากต่อการอธิบายกระบวนการตัดสินใจ เพื่อให้ผลการวิจัยมีความโปร่งใสและสามารถนำไปใช้อ้างอิงทางวิทยาศาสตร์ได้ งานวิจัยนี้จึงประยุกต์ใช้เทคนิค **Explainable AI (XAI)** เพื่อวิเคราะห์อิทธิพลของตัวแปรต่างๆ ที่มีต่ออุณหภูมิพื้นผิวดิน

### 3.6.1 SHAP (SHapley Additive exPlanations)

**SHAP** เป็นวิธีการที่พัฒนาขึ้นจากทฤษฎีเกม (Game Theory) โดยอิงหลักการของ Shapley Value เพื่อวัดค่าการมีส่วนร่วม (Contribution) ของแต่ละตัวแปรที่มีต่อผลการทำนาย หลักการคือการคำนวณค่าเฉลี่ยของผลกระทบจากการเพิ่มตัวแปรหนึ่งๆ เข้าไปในทุกชุดย่อย (Subset) ที่เป็นไปได้ของตัวแปรทั้งหมด

**สูตรการคำนวณ SHAP Value:**

$$\phi_i = \sum_{S \subseteq N \setminus \{i\}} \frac{|S|!(|N|-|S|-1)!}{|N|!} [f(S \cup \{i\}) - f(S)]$$

โดยที่:

- $\phi_i$ คือ ค่า SHAP ของตัวแปรที่ $i$
- $N$ คือ เซตของตัวแปรทั้งหมด
- $S$ คือ เซตย่อยของตัวแปร (ไม่รวม $i$)
- $f(S)$ คือ ผลการทำนายเมื่อใช้เฉพาะตัวแปรในเซต $S$

ในการศึกษานี้ ได้ใช้ SHAP ใน 2 ระดับ:

1.  **Global Interpretation:** การหาค่าเฉลี่ยของค่า SHAP (Mean Absolute SHAP Value) จากข้อมูลทั้งหมด เพื่อจัดลำดับความสำคัญของตัวแปรในภาพรวมว่า ก๊าซเรือนกระจกชนิดใด (CH₄, NO₂, CO) หรือปัจจัยสภาพแวดล้อมใดส่งผลต่อ LST มากที่สุด

2.  **Local Interpretation:** การวิเคราะห์ค่า SHAP ในระดับรายพิกเซลหรือรายพื้นที่ (Spatial Analysis) เพื่อทำความเข้าใจว่าในพื้นที่เฉพาะ (เช่น เขตเมือง หรือเขตเกษตรกรรม) ปัจจัยใดเป็นตัวขับเคลื่อนหลักที่ทำให้อุณหภูมิสูงขึ้นหรือลดลง

### 3.6.2 Permutation Feature Importance

เพื่อยืนยันผลลัพธ์ที่ได้จาก SHAP ได้ใช้วิธี **Permutation Feature Importance** ร่วมด้วย หลักการคือการวัดประสิทธิภาพของแบบจำลองที่ลดลงเมื่อทำการ "สลับค่า" (Shuffle) ของตัวแปรหนึ่งๆ แบบสุ่ม หากการสลับค่าของตัวแปรใดทำให้ค่าความแม่นยำ (R²) ลดลงอย่างมาก แสดงว่าตัวแปรนั้นมีความสำคัญสูงต่อการทำนาย

**ขั้นตอนการคำนวณ Permutation Feature Importance:**

1. คำนวณค่าความแม่นยำพื้นฐาน (Baseline Score) ของแบบจำลอง
2. สำหรับตัวแปรแต่ละตัว ทำการสลับค่าแบบสุ่ม (Random Shuffle)
3. คำนวณค่าความแม่นยำใหม่หลังจากสลับค่า
4. วัดผลต่างของความแม่นยำ: $Importance_i = Score_{baseline} - Score_{shuffled}$
5. ทำซ้ำหลายรอบเพื่อหาค่าเฉลี่ยและส่วนเบี่ยงเบนมาตรฐาน

### 3.6.3 การวิเคราะห์ทิศทางความสัมพันธ์ (Directional Analysis)

นอกเหนือจากการวัดความสำคัญของตัวแปรแล้ว งานวิจัยนี้ยังวิเคราะห์ทิศทางของความสัมพันธ์ (Positive/Negative Correlation) ระหว่างตัวแปรกับ LST โดยใช้:

1. **SHAP Summary Plot:** แสดงทั้งความสำคัญและทิศทางของอิทธิพล
2. **Partial Dependence Plot (PDP):** แสดงความสัมพันธ์เฉลี่ยระหว่างตัวแปรแต่ละตัวกับ LST
3. **Correlation Matrix:** แสดงสหสัมพันธ์ระหว่างตัวแปรทั้งหมด

การใช้หลายวิธีควบคู่กัน (SHAP, Permutation Importance, และ Correlation Analysis) ช่วยยืนยันความถูกต้องของผลการวิเคราะห์ปัจจัยขับเคลื่อน (Drivers) ของปรากฏการณ์เกาะความร้อนและการเปลี่ยนแปลงอุณหภูมิในประเทศไทยได้อย่างน่าเชื่อถือ
