## Collection- 6

## MODIS Land Surface Temperature Products

## Users' Guide

#### Zhengming Wan

#### ERI, University of California, Santa Barbara

### December 2013


#### Note:

This document is a living document that describes the Collection-6 (C6) MODIS Land
Surface Temperature (LST) products. It is revised as progress is made in the development
and assessment of the LST products. Described is the current state of the MODIS LST
products. The purpose of the document is to give the potential user of LST products an
understanding of the MODIS LST products and the data in those products.

In the early days, the MODIS LST products MOD11_L2, MOD11A1, and MOD11B
had been validated at stage 1 with in situ measurements in more than 50 clear-sky cases
in the temperature range from - 10 oC to 58oC and the column water vapor range of 0.4-
4cm, most of them presented in published papers (Wan et al., 2002 and 2004; Coll et al.,
2005; Wan, 2006; Wan, 2008; Wan and Li, 2008). Detailed validation of the C6 MODIS
LST product is given in the most recently published paper (Wan, 2014).

Please use the C6 MODIS LST product in your applications because its quality is much
better than the qualities of the C4.1 LST product (generated by the V4 algorithm from C
input data) and C5 products (generated by the V5 algorithm from C5 input data).

As shown in the following plots, the viewing angle dependence in the band 29 emissivity
values [red in daytime and green in nighttime data records] at the north Tassili site (latitude
27.0o, longitude 7.65o) in the C6 MYD11B1 LST product in 2007 [right] is much better than in
the C4.1 product [left] because the C6 LST/E product provides more stable results. Wan and Li
(2011) explained with spectral measurement results that the spectral transmittance of a
single ivy leaf (roughly 0.18-mm thickness) are negligibly small (<0.02) in the whole TIR
spectral region in its fresh condition and very small (<0.03) in the 6–14μm region in its
dry condition and that the emissivity of the single ivy leaf varies significantly with water
content only in the 3.5–6μm spectral region, and its variation in the 8–14μm region is
negligible. It is reasonable to expect the most top thin layer (with thickness in a few
tenths of one mm) of land surface in bare soil regions is staying in dry conditions during
the daytime in clear-sky days so that the surface emissivity will not change significantly
during daytime in clear-sky conditions.


#### Table of Contents

###### 1. INTRODUCTION

1.1. File Format of LST Products
1.2. Sequence of LST Products

2. MOD11_L2 LST PRODUCT

2.1. Algorithm Description
2.2. Scientific Data Sets
2.3. Local Attributes
2.4. Global Attributes
2.5. Quality Assurance

3. MOD11A1 DAILY LST PRODUCT

3.1. Algorithm Description
3.2. Scientific Data Sets
3.3. Local Attributes
3.4. Global Attributes
3.5. Quality Assurance

4. MOD11A2 EIGHT-DAY LST PRODUCT

4.1. Algorithm Description
4.2. Scientific Data Sets
4.3. Local Attributes
4.4. Global Attributes
4.5. Quality Assurance

5. MOD11B1 DAILY LST PRODUCT

5.1. Algorithm Description
5.2. Scientific Data Sets
5.3. Local Attributes
5.4. Global Attributes
5.5. Quality Assurance

6. MOD11B2 8-DAY LST PRODUCT

6.1. Algorithm Description
6.2. Scientific Data Sets
6.3. Local Attributes
6.4. Global Attributes
6.5. Quality Assurance

7. MOD11B3 MONTHLY LST PRODUCT

7.1. Algorithm Description
7.2. Scientific Data Sets
7.3. Local Attributes
7.4. Global Attributes
7.5. Quality Assurance


###### 8. MOD11C1 DAILY CMG LST PRODUCT

8 .1. Algorithm Description
8 .2. Scientific Data Sets
8 .3. Local Attributes
8 .4. Global Attributes
8 .5. Quality Assurance

9. MOD11C2 8-DAY CMG LST PRODUCT

9 .1. Algorithm Description
9 .2. Scientific Data Sets
9 .3. Local Attributes
9 .4. Global Attributes
9 .5. Quality Assurance

10. MOD11C3 MONTHLY CMG LST PRODUCT

10 .1. Algorithm Description
10 .2. Scientific Data Sets
10 .3. Local Attributes
10 .4. Global Attributes
10 .5. Quality Assurance

11. Publications and References

12. Related Documents


#### 1. Introduction

The MODIS LST products are created as a sequence of products beginning with a swath
(scene) and progressing, through spatial and temporal transformations, to daily, eight-day
and monthly global gridded products. The algorithms and data content of these LST
products are briefly described in this guide with the purpose of providing a user with
sufficient information about the content and structure of the data files to enable the user
to access and use the data. Overviews of the file format and sequence of MODIS LST
products are given first. Descriptions of each algorithm and product content are given in
following sections. Publications and documents related to the MODIS LST products are
listed in the last two sections.

The major refinements implemented in the V6 daily LST Product Generation Executive
(PGE) code are given in (Wan, 2014). This V6 PGE code has been used in the

#### Collection-6 (C6) reprocessing and forward processing of the MODIS LST product.

##### 1.1. File Format of LST Products

The MODIS LST products are archived in Hierarchical Data Format - Earth Observing
System (HDF-EOS) format files. HDF, developed by the NSCA, is the standard archive
format for EOS Data Information System (EOSDIS) products. The LST product files
contain global attributes (metadata) and scientific data sets (SDSs) (arrays) with local
attributes. Unique in HDF-EOS data files is the use of HDF features to create point,
swath, and grid structures to support geolocation of data. These structures (Vgroups and
Vdata) provide geolocation relationships between data in an SDS and geographic
coordinates (latitude and longitude or map projections) to support mapping the data.
Global and local attributes (metadata) provide various information about the data. Users
unfamiliar with HDF and HDF-EOS formats may wish to consult Web sites listed in the
Related Web Sites section for more information.

LST data product files contain three EOS Data Information System (EOSDIS) Core
System (ECS) global attributes, which are also referred to as metadata by ECS. These
ECS global attributes (CoreMetadata.0, ArchiveMetadata.0 and StructMetadata.0)
contain information relevant to production, archiving, user services, geolocation and
analysis of data. The ECS global attributes are written in parameter value language (PVL)
and are stored as a character string. Metadata and values are stored as objects within the
PVL string. Results of the LST algorithms are stored as SDSs with local attributes. Local
attributes include summary statistics and other information about the data in an SDS or a
key to data values. Detailed descriptions of each LST product are given in following
sections.

Products may also contain product specific attributes (PSAs) defined by the product
developers as part of the ECS CoreMetadata.0 attribute. Geolocation and gridding
relationships between HDF-EOS point, swath, and grid structures and the data are
contained in the ECS global attribute, StructuralMetadata.0.


A separate file containing metadata will accompany data products ordered from a DAAC.
That metadata file will have a .met extension and is written in PVL. The .met file
contains some of the same metadata as in the product file but also has other information
regarding archiving and user support services as well as some post production quality
assurance (QA) information relevant to the product file ordered. The post production QA
metadata may or may not be present depending on whether or not the data file has been
investigated. The .met file should be examined to determine if post production QA has
been applied to the product file. (The Quality Assurance sections of this guide provide
information on post production QA.)

The data products were generated in the science data production system using the HDF-
EOS toolkit, Science Data Processing (SDP) Toolkit, HDF API and the C programming
language. Various software packages, commercial and public domain, are capable of
accessing the HDF-EOS files.

##### 1.2. Sequence of LST Products

C6 MODIS LST data products are produced as a series of nine products. The sequence
begins as a swath (scene) at a nominal pixel spatial resolution of 1km at nadir and a
nominal swath coverage of 2030 or 2040 lines (along track, about five minutes of
MODIS scans) by 1354 pixels per line in the daily LST product. There are two
algorithms used in the daily MODIS LST processing: (1) the generalized split-window
LST algorithm (Wan and Dozier, 1996), and (2) the day/night LST algorithm, which uses
a pair of daytime and nighttime L1B data in seven TIR bands, atmospheric temperature
and water vapor in the MODIS atmospheric product MOD07_L2. BRDF parameters in
the MODIS BRDF product MOD43B1C are also used since the V4 LST processing. Wan
(2014) described new refinements made in these two algorithms for the C6 MODIS LST
product.

Data product levels briefly described: Level 1B (L1B) is a swath (scene) of MODIS data
geolocated to latitude and longitude centers of 1 km resolution pixels. A level 2 (L2)
product is a geophysical product that remains in latitude and longitude orientation; it has
not been temporally or spatially manipulated. A level 3 (L3) product is a geophysical
product that has been temporally and or spatially manipulated, and is usually in a gridded
map projection format referred to as tiles. Each tile is a piece, e.g., about 1113km by
1113km in 1200 rows by 1200 columns, of a map projection.

A summarized listing of the sequence of products is given in Table 1. Products in
EOSDIS are labeled as Earth Science Data Type (ESDT). The ESDT label "shortname" is
used to identify the LST data products. Each LST product in the sequence is built from
the previous LST products. These LST products are identified, in part, by product levels
in EOSDIS which indicate what spatial and temporal processing has been applied to the
data.


Table 1. Summary of the C6 MODIS LST data products.

```
Earth Science
Data Type
(ESDT)
```
```
Product Level
```
```
Nominal Data
Array
Dimensions
```
```
Spatial
Resolution
```
```
Temporal
Resolution
```
```
Map
Projection
```
```
MOD11_L2 L
```
```
2030 or 2040
lines
by 1354 pixels
per line
```
```
1km at nadir swath (scene)
None. (lat,lon
referenced)
```
MOD11A1 L3 (^) 1200 columns1200 rows by
1km
(actual
0.928km)
daily Sinusoidal
MOD11B
L3 (^) 200 columns200 rows by
6km
(actual
5.568km)
daily
MOD11B2 eight days Sinusoidal
MOD11B3 monthly
MOD11A2 L3 1200 rows by
1200 columns
1km
(actual
0.928km)
eight days Sinusoidal
MOD11C1 L3 360° by 180° (global) 0.05° by 0.05° daily equalgeographic-angle
MOD11C2 L3 360° by 180°
(global)
0.05° by 0.05° eight days equal-angle
geographic
MOD11C3 L3 360° by 180°
(global)
0.05° by 0.05° monthly equal-angle
geographic
Brief descriptions of the LST data products are given here to give perspective to the
sequence. Expanded descriptions of the LST products are given in following sections.
The first product, MOD11_L2, is a LST product at 1km spatial resolution for a swath.
This product is the result of the generalized split-window LST algorithm (Wan and
Dozier, 1996). Geolocation data (latitude and longitude) at a coarse resolution (5 lines by
5 samples) is also stored in the product. The second product, MOD11A1, is a tile of daily
LST product at 1km spatial resolution. It is generated by mapping the pixels in the
MOD11_L2 products for a day to the Earth locations on the sinusoidal projection. The
third product, MOD11B1, is a tile of daily LST and emissivities at 6km spatial resolution.
It is generated by the day/night LST algorithm (Wan and Li, 1997). The fourth product,
MOD11B2, is an eight-day LST product by averaging from two to eight days of the
MOD11B1 product. The fifth product, MOD11B3, is a monthly LST product generated
from the daily MOD11B1 product. The sixth product, MOD11A2, is an eight-day LST
product by averaging from two to eight days of the MOD11A1 product. The seventh
product, MOD11C1, is a daily global LST product in a geographic projection. It is
created by assembling the MOD11B1 daily tiles together and resampling the SDSs at
6km grids to the 0.05° spatial resolution of the Climate Modeling Grid (CMG) cells. The
eighth product, MOD11C2, is an eight-day composite of LST at the same resolution as
MOD11C1. The ninth product, MOD11C3, is a monthly composite of LST at the same


resolution as MOD11C2. Similarly, there are nine C6 LST products starting with MYD
for the Aqua MODIS.

#### 2. MOD11_L2 LST Product

This product is generated using the MODIS sensor radiance data product (MOD021KM),
the geolocation product (MOD03), the atmospheric temperature and water profile product
(MOD07_L2), the cloud mask product (MOD35_L2), the landcover (MCDLC1KM), and
snow product (MOD10_L2). The output file contains SDSs of LST, quality assurance
(QA), error in LST, emissivities in bands 31 and 32, viewing zenith angle and time,
latitude and longitude (each set of latitude and longitude for every 5 scan lines and 5
pixels), local attributes, and global attributes. This LST product is generated by the
generalized split-window LST algorithm (Wan and Dozier, 1996). For complete global
coverage a MOD11_L2 LST product would be generated for all swaths acquired in
daytime and nighttime on the Earth including the polar region.

The algorithm and data product contents for MOD11_L2 are described in the following
sections.

##### 2.1. Algorithm Description

A brief sketch of the LST algorithm for MOD11_L2 is described here for the purpose of
aiding the user in understanding and interpreting the data product.

The LST retrieval in a MODIS swath is constrained to pixels that:

( 1 ), have nominal Level 1B radiance data in bands 31 and 32,
(2), are on land or inland water,
( 3 ), are in clear-sky condition at a confidence (defined in MOD35) of >=95% over land
or lakes.

Note that the above clear-sky condition for the LST values in the C6 level-2 MOD11_L
product is more stricter than the clear-sky conditions for the LST values in the C6 level- 3
MOD11A1 product (at a confidence >=95% over land <= 2000m or >= 66% over land
> 2000m, and at a confidence of >= 66% over lakes). For the C5 and C6 level-3 LST
products, cloud-contaminated LSTs in the 1km product (MOD11A1 & MYD11A1) and
the 6km product (MOD11B1 & MYD11B1) will be removed by using constraints on the
temporal variations in clear-sky LSTs in a period of 32 days by the refinement
implemented in the PGE16 (Wan, 2008). However, there is no easy way to implement
such a post-processing to remove the cloud-contaminated LSTs in the C6 level- 2
products (MOD11_L2 & MYD11_L2).

Clouds are masked with the MODIS Cloud Mask data product (MOD35_L2). Because
band 22 is used in the 4-11 micron test to determine the cloudyness of a pixel in the
MODIS cloudmask algorithm, the noisy fourth channel in band 22 produced quite a lot of
(cloud) strips in the cloudmask product based on the old A-side MODIS data (prior to
October 30, 2000). To avoid the strips caused by the noisy channels, the cloudmask in all
fourth channels of the scan cubes (one scan cub contains ten channels in each band) is
refined with the adjacent pixels in the third and fifth channels.


Masking of oceans is done with the 1 km resolution land/water mask, contained in the
MODIS geolocation product (MOD03).

Data inputs to the LST algorithm are listed in Table 2.

Table 2. MODIS data product inputs to the MODIS LST algorithm for the MOD11_L2 product.

```
ESDT Long Name Data Used
```
MOD021KM MODIS Level 1B Calibrated and Geolocated Radiances

```
EV_1KM_Emissive for MODIS
```
#### bands:

#### 31 (11.03 μm)

```
32 (12.02 μm)
```
#### Latitude (every 5 lines)

```
Longitude (every 5 pixels)
```
MOD03 MODIS Geolocation

#### Land/Water Mask

#### Height

#### Sensor Zenith Angles

#### Solar Zenith Angles

#### Latitude

#### Longitude

EV start time
MOD35_L2 MODIS Cloud Mask Cloud_Mask

#### MOD07_L2 MODIS Atmospheric Profile RetrievedWater_Vapor_Temperature _Profile^

MCDLC1KM Land Cover Land_Cover_Type_
MOD10_L2 MODIS Snow Cover Snow Cover Fraction

#### Emissivity values in bands 31 and 32 are estimated by the classification-based

#### emissivity method (Snyder and Wan, 1998) according to land cover types in the

#### pixel determined by the input data in Land Cover (MCDLC1KM) and daily

#### Snow Cover (MOD10_L2). The land-cover product generated from MODIS

#### data is used in the MODIS LST processing.

#### Because the range of diurnal variation in LSTs over the seasons at the bare soil

#### sites is very wide it is necessary to use two separate sets of split-window

#### algorithm coefficients for the type of bare soil in the hot and warm bare soil

#### zone (HAWBSZ) within latitude range from −38° to 49.5°, one set for daytime

#### LSTs and another for nighttime LSTs. Atmospheric radiative transfer

#### simulations were made with MODTRAN4 code (Berk et al., 1999) in wide

#### atmospheric and LST conditions: the range of the atmospheric surface

#### temperature (Ts-air) is set as 280–325K for the daytime and 275–305K for the

#### nighttime; the atmospheric column water vapor varies from nearly zero to

#### 5.5cm; and the range of (LST – Ts-air) is set as from 8–29K for daytime LSTs

#### and from −10–4K for nighttime LSTs. A quadratic term of the difference

#### between brightness temperatures in bands 31 and 32 was added into the original

#### viewing angle dependent split-window algorithm in order to improve the LST

#### retrieval accuracy slightly (Wan, 2014).


#### A large uncertainty may exist in such estimated emissivity values in semi-arid

#### and arid areas. Therefore, a prototype emissivity adjustment model was developed by

comparing the (T31–T32) values in MODIS data to simulation values estimated from
column water vapor (cwv) and surface air temperature (Ta-surf), and correspondingly
adjusting the emissivity in band 31 (em31 or ε31) with a value in range of ±0.0063 and
the band 32 emissivity em32 (ε32) by the same amount in the opposite direction (Wan,
2014).

##### 2.2. Scientific Data Sets (SDS)

The MODIS L2 LST product contains nine scientific data sets (SDSs): LST, QC,
Error_LST, Emis_31, Emis_32, View_angle, View_time, Latitude, and Longitude. The
first seven DSDs are for 1km pixels. The last two DSDs are coarse resolution (five lines
by five samples) latitude and longitude data. Each set of them correspond to a center
pixel of a 5 lines by 5 pixels in the LST SDS. A mapping relationship of geolocation data
to the first seven DSDs is specified in the global attribute StructMetadata.0. The mapping
relationship was created by the HDF-EOS SDPTK toolkit during production. Geolocation
data is mapped to the first seven DSDs data with an offset = 2 and increment = 5. The
first element (0,0) in the geolocation SDSs corresponds to element (2,2) in LST SDS,
then increments by 5 in the cross-track or along-track direction to map geolocation data
to the LST SDS element. Details are shown in Table 3.

Table 3. The SDSs in the MOD11_L2 product.

#### SDS

```
Name
```
#### Long

```
Name
```
#### Number

```
Type Unit^
```
#### Valid

```
Range
```
#### Fill

```
Value
```
#### scale

```
factor
```
#### add

```
offset
```
#### LST Landtemperature-surface uint16 K 655357500 - 0 0.02 0.

#### QC Quality control forLST and emissivity^ uint 16 none 0 - 65535 0 NA NA

#### Error_LST Landtemperature error-surface^ uint8 K 1 - 255 0 0.04 0.

```
Emis_31 Band 31 emissivity uint8 none 1 - 255 0 0.002 0.
Emis_32 Band 32 emissivity uint8 none 1 - 255 0 0.002 0.
```
#### View_angle zenith angle of MODISviewing at the pixel uint8 deg 0 - 180 0 0.5 0

```
View_time
```
#### Time* of Land-surface

#### Temperature observation

```
(* as local solar time)
```
```
uint8 hrs 0 - 240 0 0.1 0
```
Latitude Latitude of every 5 scanlines and 5 pixels float32 degree (^) to 90.0-90.0^ 999.9- NA NA
Longitude Longitude of every 5 scanlines and 5 pixels float32 degree (^) to 180.0-180.0^ 999.9- NA NA


Note that the Error_LST value is only an estimated value. It is quite conservative in real
clear-sky conditions. However, the effect of cloud contaminations is not considered in the
error estimation.

##### 2.3. Local Attributes

Archived with the "LST" SDS are local attributes including the coefficients of the
calibration which converts the SDS value to real LST value in K. HDF predefined local
attributes (Table 4 ) describe characteristics of the data.

Table 4. HDF-predefined local attributes for SDS LST in the MOD11_L2 product.

#### Attribute

```
Name
```
#### Reserved

```
Label(s) Definition^ Sample Value^
```
Label long_name Long Name of the SDS LandTemperature-surface

Unit units SI units of the data, if any K

Format Number Type How the data are stored (^) unsigned integer)uint16 (16-bit
Range valid_range Max and min values within a selected data range 7500 - 65535 *
Fill Value _FillValue Data used to fill gaps in the swath 0
Calibration

#### scale_factor

#### add_offset

#### scale_factor_err

#### add_offset_err

```
calibrated_nt
```
#### scaling factor

#### add offset

#### scaling factor error

#### add offset error

```
calibrated nt
```
#### 0.

#### 0.

#### 0.

#### 0.

###### 0.

* The number 65535 in uint16 may be shown as -1s in 16-bit integer by some software
toolkits, for example, by ncdump in the HDF toolkit.

The effective calibration formula for the "LST" SDS is
LST = the SDS data in uint16 * 0.02, giving a value in the range of 150-1310.7K.

##### 2.4. Global Attributes

There are three global ECS attributes, i.e., CoreMetadata.0, ArchiveMetadata.0, and
StructMetadata.0, in the MOD11_L2 data product. Contents of these global attributes
were determined and written during generation of the product and are used in archiving
and populating the EOSDIS database to support user services. They are stored as very
long character strings in parameter value language (PVL) format. Descriptions of the
global attributes are given here to assist the user in understanding them.

CoreMetadata.0 is the global attribute in which information compiled about the product
during product generation is archived and is used to populate the EOSDIS database to
support user services. The content of the global attributes with sample values and
comment of definition are listed in Table 6 , Table 7, and Table 8, respectively. The user
wanting detailed explanations of the global attributes and related information should
query the EOSDIS related web sites.


Table 5. Listing of objects in the global attribute CoreMetadata.0 in MOD11_L2.

```
Object Name Sample Value Comment
```
ShortName "MOD11_L2" ESDT productname of

VersionID 6 ECS Version
ReprocessingActual "reprocessed"

ReprocessingPlanned "further update is anticipated"

Expect that products
will be reprocessed
one or more times.
LocalGranuleID "MOD11_L2.A2000095.1915.005.20006208231007.hdf"^
DayNightFlag "Day" Day , Night or Both.
ProductionDateTime " 2006 - 07 - 27T23:10:07.000Z"

LocalVersionID "6.4.0A"

```
Version of algorithm
delivered from the
SCF.
```
PGEVersion "6.4.0"

```
Version of
production
generation
executable.
```
InputPointer "MOD03.A2000095.1915.005.2006188045128.hdf","..."

```
Location of input
files in the
production system.
```
RangeBeginningDate "2000- 04 - 04 " (^) Beginning and
ending times of the
first and last scan line
in the swath.
RangeBeginningTime "19:15:00.000000"
RangeEndingDate "2000- 04 - 04 "
RangeEndingTime "19:20:00.000000"
ExclusionGRingFlag "N"
Geographic bounds
of swath coverage.
GRingPointLatitude [54.085346, 49.240036, 32.346612, 35.789540]
GRingPointLongitude [ -135.759611-134.529204, ] - 100.841011, -110.349156,^
GRingPointSequenceNo [1,2,3,4]
OrbitNumber 1579
EquatorCrossingLongitude - 131. 114787
EquatorCrossingDate "2000- 04 - 04 "
EquatorCrossingTime "19:29:39.345204"
ParameterName "MODIS LST"
AutomaticQualityFlag
"Passed"
Result of automated
checks during the run
of the algorithm that
screen for significant
amounts of
anomalous data.
AutomaticQualityFlagExplanation “the PGE.No automatic quality assessment is performed in ”
Explanation of result
of automated QA
checks made during
execution.
ScienceQualityFlag "Not Investigated" Set by Linvestigator after ST


```
post-production
investigation
```
SciencelQualityFlagExplanation

```
"See http://landweb.nascom/nasa.gov/cgi-
bin/QA_WWW/qaFlagPage.cgi?sat=terra the
product Science Quality status."
```
```
Explanation of
Science Flag
```
QAPercentMissingData 0 0 - 100
QAPercentCloudCover 60 0 - 100

AncillaryInputPointer "MOD03.A2000095.1915.005.2006188045128.hdf"^

```
Location of
geolocation input
product in production
system.
```
AncillaryInputType "Geolocation"

Type of ancillary
data referenced by
pointer.
AssociatedSensorShortName "MODIS"
AssociatedPlatformShortName "Terra"
AssociatedInstrumentShortName "MODIS"
Product Specific Attributes (PSA)

QAPercentGoodQuality (^29) Summary quality
assurance statistic for
data product. Range
is from 0-100.
QAPercentOtherQuality 8
QAPercentNotProducedCloud 33
QAPercentNotProducedOther 29
GranuleNumber 233 Unique granule identifier
QAFractionGoodQuality 0. (^2947352) Summary fraction of
the LST product.
Range is from 0.0 to
1.0.
QAFractionOtherQuality 0.0 831999
QAFractionNotProducedCloud 0. 3331286
QAFractionNotProducedOther 0. 2889363
The four QAFraction PSAs are especially useful to granules in ocean regions where only
a small number of island pixels exist. Because the total number of land and coastal pixels
is highly variable in granules covering both land and ocean, the values of QAPercent and
QAFraction PSAs are calculated on the base of the total number of all pixels in a
granule. Therefore, we can always calculate how many pixels with LST in good quality
and other quality from these PSA values, even for island pixels.
The ECS global attribute ArchiveMetadata.0 contains information relevant to production
of the data product. It also contains an alternate bounding of geographic coverage of the
swath. These data may be useful in determining what version of the algorithm was used
to generate the product. Contents are described in Table 6.
Table 6. Listing of objects in the global attribute ArchiveMetadata.0 in MOD11_L2.
Object Name Typical Value Comment
EastBoundingCoordinate - 10 0.843259 (^) Extent of swath
coverage, in latitude
and longitude.
WestBoundingCoordinate - 13 5.
NorthBoundingCoordinate 5 4.


SouthBoundingCoordinate 32.

AlgorithmPackageAcceptanceDate "102004"

```
Algorithm
Descriptors
```
AlgorithmPackageMaturityCode "Normal"
AlgorithmPackageName "MOD_PR11A"

AlgorithmPackageVersion "6"

InstrumentName
"Moderate-Resolution Imaging
SpectroRadiometer"

ProcessingDateTime "2006- 07 - 27T23:10:07.000Z"

LongName

"MODIS/Terra Land Surface
Temperature/Emissivity 5-Min L2 Swath
1km"
ProcessingCenter "MODAPS"

SPSOParameters "2484 and 3323"

LocalInputGranuleID "MOD021KM.A2000095.1915..." input L1B HDF file.

The StructMetadata.0 global attribute is used by the HDF-EOS toolkit to specify the
mapping relationships between the geolocation data and the LST data (SDSs). Mapping
relationships are unique in HDF-EOS and are stored in the product using HDF structures.
Description of the mapping relationships is not given here. Use of HDF-EOS toolkit,
other EOSDIS supplied toolkits may be used to geolocate the data.

Table 7. Listing of objects in the global attribute StructMetadata.0 in MOD11_L2.

Object Definition
DIMENSION_1 along_swath_lines_1km (10*nscans)

DIMENSION_2 Cross_swath_pixels_1km (Max_EV_frames)
DIMENSION_3 Coarse_swath_lines_5km (2*nscans)

DIMENSION_4 Coarse_swath_pixels_5km (Max_EV_frames/5)

DIMENSIONMAP_

```
GeoDimension= Coarse_swath_lines_5km
DataDimension= along_swath_lines_1km
Offset=2 Increment=
```
DIMENSIONMAP_

GeoDimension= Cross_swath_pixels_1km
DataDimension= Cross_swath_pixels_1km
Offset=2 Increment=
GEOFIELD_1 GeoFieldName=Latitude

GEOFIELD_2 GeoFieldName=Longitude

DATAFIELD_1 DataFieldName=LST
DATAFIELD_2 DataFieldName=QC

DATAFIELD_3 DataFieldName=Error_LST

DATAFIELD_4 DataFieldName=Emis_
DATAFIELD_5 DataFieldName=Emis_

DATAFIELD_6 DataFieldName=View_angle

DATAFIELD_7 DataFieldName=View_time


##### 2.5. Quality Assurance

Indicators of quality are given in metadata objects in the CoreMetadata.0 global attribute
QA and in a quality control (QC) SDS, generated during production, or in post-product
scientific and quality checks of the data product. QA metadata objects in the
CoreMetadata.0 global attribute are the AutomaticQualityFlag and the
ScienceQualityFlag and their corresponding explanations. The AutomaticQualityFlag is
set according to rules based on data conditions encountered during a run of the LST
algorithm. Setting of this QA flag is fully automated. The rules used to set it are liberal;
nearly all of the data or intermediate calculations would have to be anomalous for it to be
set to "Failed". Typically, it will be set to "Passed". The ScienceQualityFlag is set post
production either after an automated QA program is run on the data product or after the
data product is inspected by a qualified LST investigator. Content and explanation of this
flag are dynamic so it should always be examined if present. A sampling of products will
be inspected. Sampling may be random, in support of field campaigns, or event driven.

The QC SDS in the data product provides additional information on algorithm results for
each pixel. The QC SDS unsigned 16 - bit data are stored as bit flags in the SDS. This QC
information can be extracted by reading the bits in the 16-bit unsigned integer. The
purpose of the QC SDS is to give the user information on algorithm results for each pixel
that can be viewed in a spatial context. The QC information tells if algorithm results were
nominal, abnormal, or if other defined conditions were encountered for a pixel. The QC
information should be used to help determine the usefulness of the LST data for a user's
needs. The bit flags in the QC SDS are listed in Table 8.

Table 8. Bit flags defined in the QC SDS in the MOD11_L2 product. Note that bit 0 is the least
significant bit.

```
bits Long Name Key
```
1 & 0 Mandatory QA flags

#### 00=Pixel produced, good quality, not necessary to examine

#### more detailed QA

#### 01=Pixel produced, unreliable or unquantifiable quality,

#### recommend examination of more detailed QA

#### 10=Pixel not produced due to cloud effects

#### 11=Pixel not produced primarily due to reasons other than cloud

```
(such as ocean pixel, poor input data)
```
3 & 2 Data quality flag

#### 00=good data quality of L1B in bands 31 and 32

#### 01=missing pixel

#### 10=fairly calibrated

```
11=poorly calibrated, LST processing skipped
```
5 & 4 Cloud flag

#### 00=cloud free pixel

#### 01=pixel only with thin cirrus

#### 10=fraction of sub-pixel clouds<= 2/

```
11=LST affected by nearby clouds
```
7 & 6 LST model number

#### 00=generalized split-window method

#### 01=day/night method

#### 10=high LST w/o atmospheric & emis corrections

```
11=cirrus effects corrected
```

9 & 8 LST quality flag

#### 00=no multi-method comparison

#### 01=multi-method comparison done

#### 10=fair consistency

```
11=good consistency
```
11 & 10 Emissivity flag

#### 00=inferred from land cover type

#### 01=MODIS retrieved

#### 10=TBD

```
11=default value used
```
13 & 12 Emis quality flag

#### 00=emis quality not checked

#### 01=emis quality checked with land cover type

#### 10=emis quality checked with NDVI

```
11=emis view-angle dependence checked
```
15 & 14 Emis error flag

#### 00=error in emis_31 emis_32 <= 0.

#### 01=error in emis_31 emis_32 <= 0.

#### 10=error in emis_31 emis_32 <= 0.

```
11=error in emis_31 emis_32 > 0.
```
It should be noted that fillvalue 0 listed for the SDS QC in Table 9 is valid for the bit
flags only when a fillvalue 0 is present in the SDS LST pixels (so the 00-01 bits in the
QC pxels have a value of 10 or 11). A value of 0 in the QC bit flags means good data
quality, cloud free, or small error in emis_31 and emis_32, and etc, if a pixel has a valid
LST value. We do not discriminate fillvalue 0 from valid value 0 for all bit flags in the
QC in order to minimize the data volume. Users should read SDSs LST and QC at the
same time in order to properly interpret their values in an easy way.

#### 3. MOD11A1 Daily LST

The daily level 3 LST product at 1km spatial resolution is a tile of daily LST product
gridded in the Sinusoidal projection. A tile contains 1200 x 1200 grids in 1200 rows and
1200 columns. The exact grid size at 1km spatial resolution is 0.928km by 0.928km.

##### 3.1. Algorithm Description

The C6 daily MOD11A1 LST product is constructed with the daily LST pixel values in
each granules retrieved by the generalized split-window algorithm under clear-sky

#### conditions defined in MOD35 (at a confidence >=95% over land <= 2000m or

#### >= 66% over land > 2000m, and at a confidence >= 66% over lakes) through

mapping all the valid clear-sky LST values onto grids in the sinusoidal projection and
averaging the LST values of overlapping pixels in each grid with overlapping areas as

#### weight.

As latitude increases beyond 30 degrees, there may be multiple MODIS observations in
clear-sky conditions. In the C6 MOD11A1 product, LST values at all grids are from
single clear-sky MODIS observations by selecting clear-sky LSTs at smaller viewing
zenith angles or the LSTs at larger zenith angles but their values being larger by at least
2K.

##### 3.2. Scientific Data Sets (SDS)

The SDSs in the MOD11A1 product include LST_Day_1km, QC_Day, Day_view_time,
Day_view_angl, LST_Night_1km, QC_Night, Night_view_time, Night_view_angl,


Emis_31, Emis_32, Clear_day_cov, Clear_night_cov, as shown in Table 9. Note that the
Day_view_time and Night_view_time are in local solar time, which is the UTC time plus
grid’s longitude in degrees / 15 degrees (in hours, +24 if local solar time < 0 or -24 if
local solar time >= 24). The data day in the name of all the daily MOD11A1 files is in
UTC so the data day in local solar time at each grid may be different from the data day in
UTC by one day. The scale factor and offset for Day_view_angle and Night_view_angle
in C6 Level-3 MODIS LST products have been changed so that a negative sign of the
viewing angle means MODIS viewing the grid from east. The view zenith angle itself is

#### always a positive number, the zenith angle from nadir. The information of MODIS

viewing the grid from east or west may be important in understanding the view angle
effect in the temporal variations in LSTs, especially in rugged regions.

Table 9. The SDSs in the MOD11A1 product.

#### SDS

```
Name
```
#### Long

```
Name
```
#### Number

```
Type Unit^
```
#### Valid

```
Range
```
#### Fill

```
Value
```
#### scale

```
factor
```
#### add

```
offset
```
#### LST_Day_1km Daily daytime 1km gridLand-surface Temperature^ uint16 K 655357500 - 0 0.02 0.

#### QC_Day Quality control for daytimeLST and emissivity uint8 none 0 - 255 0 NA NA

#### Day_view_time (local solar) TimTemperature observatione of daytime Land-surface^ uint8 hrs 0 - 240 0 0.1 0

#### Day_view_angle View zenith angle of daytimeLand-surface Temperature uint8 deg 0 - 130 255 1.0 - 65.

#### LST_Night_1km Daily nighttime 1km gridLand-surface Temperature^ uint16 K 655357500 - 0 0.02 0.

#### QC_Night Quality control for nighttimeLST and emissivity uint8 none 0 - 255 0 NA NA

```
Night_view_time
```
```
(local solar) Time of nighttime Land-
```
#### surface

```
Temperature observation
```
```
uint8 hrs 0 - 240 0 0.1 0
```
#### Night_view_angle View zenith angle of nighttimeLand-surface Temperature uint8 deg 0 - 130 255 1.0 - 65.

```
Emis_31 Band 31 emissivity uint8 none 1 - 255 0 0.002 0. 49
Emis_32 Band 32 emissivity uint8 none 1 - 255 0 0.002 0.
Clear_day_cov day clear-sky coverage uint16 none 655350 - 0 0.000 5 0.
```
```
Clear_night_cov night clear-sky coverage uint16 none 655350 - 0 0.000 5 0.
```
##### 3.3. Local Attributes

The local attributes for SDSs LST_Day_1km and LST_Night_1km are similar to those in
Table 4.

##### 3.4. Global Attributes

Three ECS global attributes and 12 product-specific global attributes are stored as
metadata. The ECS global attributes, CoreMetadata.0, ArchiveMetadata.0 and
StructMetadata.0 are stored as very long character strings in PVL format.


CoreMetadata.0 contains information about the product during production and is used to
populate the EOSDIS data base for user support. A listing of objects along with sample
values is given in Table 10.

Table 10. CoreMetadata.0 of the MOD11A1 data product.

```
Object Name Sample Value Comment
```
ShortName "MOD11A1"

```
ESDT
name of
product
```
VersionID 6 ESC Version

ReprocessingActual "reprocessed"

```
Number of
times
processed.
```
ReprocessingPlanned "further update is anticipated"

```
Expect that
products
will be
reprocessed
one or more
times
```
LocalGranuleID "MOD11A1.A2000095.h08v05.005.2006209..hdf" Name^ of
the granule.
DayNightFlag "Both"

ProductionDateTime "2006- 07 - 28T06:11:25.000Z"

```
Time
granule was
produced.
```
LocalVersionID "6.4.0AS"

```
Version of
algorithm
delivered
from the
SCF
```
PGEVersion "6.4.0"

```
Version of
PGE in
MODAPS.
```
InputPointer

```
"MOD03.A2000095.1920...hdf",
"MOD021KM.A2000095...hdf",
...
```
Location of
input files
in the
production
system
RangeBeginningDate "2000- 04 - 04 " Beginning
and ending
times of the
first and
last scan
line in the
swath

RangeBeginningTime "00:00:00"

RangeEndingDate "2000- 04 - 04 "

RangeEndingTime "23:59:59"

ExclusionGRingFlag "N" latitude and


GringPointLatitude [39.995833, 39.995833, 30.004167, 30.004167] longitude
values of
the corner
grids in the
tile

GringPointLongitude [-130.540731, -117.497536,^ - 103.941403,^

- 115.479755]

GringPointSequenceNo [1, 2, 3, 4]

ParameterName "MOD 1KM L3 LST"

```
Parameter
for which
QA
statistics
are given in
this
metadata
object.
```
AutomaticQualityFlag "Passed"

```
Result of
automated
checks
done on the
data during
a run of
algorithm.
```
AutomaticQualityFlagExplanation "No automatic quality assessment is performed in
the PGE."

```
Explanation
of result of
automated
QA checks
made
during
execution.
```
ScienceQualityFlag "Not Investigated"

SciencelQualityFlagExplanation

```
"See http://landweb.nascom.nasa.gov/cgi-
bin/QA_WWW/qaFlagPage.cgi?sat=terra for the
product Science Quality status."
```
Explanation
of Science
QualityFlag
QAPercentMissingData 0 0 - 100

QAPercentCloudCover 2 0 - 100

AssociatedPlatformShortName "Terra"
AssociatedInstrumentShortName "MODIS"

AssociatedSensorShortName "MODIS"

**Product Specific Attributes (PSA)**
QAPercentGoodQuality 32 Summary
quality
assurance
statistic for
data
product. (

- 100)

QAPercentOtherQuality 45

QAPercentNotProducedCloud 2

QAPercentNotproducedOther 21

N_GRAN_POINTERS "27"

```
the number
of granules
considered
```

```
for the tile
```
HorizontalTileNumber "08"

VerticalTileNumber "05"
TileID " 11008 005"

QAFractionGoodQuality 0.3172743 Summary
fraction of
the LST
product.
Range is
from 0.0 to
1.0.

QAFractionOtherQuality 0. 4461764

QAFractionNotProducedCloud 0. 0237937

QAFractionNotProducedOther 0. 2127556

The ECS global attribute ArchiveMetadata.0 contains information relevant to the input
data, an alternate geographic coverage bounds, and information relevant to version of the
algorithm and product. A listing of objects along with sample values is given in Table 1 1.

Table 11. ArchiveMetadata. 0 of the MOD11A1 data product.

Object Name Sample Value Comment
HorizontalTileNumber "08"

VerticalTileNumber "05"

AlgorithmPackageAcceptanceDate "102004"

```
Algorithm
Descriptors
```
AlgorithmPackageMaturityCode "Normal"

AlgorithmPackageName "MOD_PR11A"

AlgorithmPackageVersion "6"

InstrumentName
"Moderate-Resolution Imaging
SpectroRadiometer"

ProcessingDateTime "2006- 07 - 27T23:09:54.000Z"

LongName
"MODIS Level-3 1km Land Surface
Temperature and Emissivity"

ProcessingCenter "MODAPS"
SPSOParameters "2484 and 3323"

LocalInputGranuleID "1920,0535,0540,0715,1740,1915" only keep the time IDs

EastBoundingCoordinate - 103.

```
Extent of the
tile coverage.
```
WestBoundingCoordinate - 1 30.
NorthBoundingCoordinate 39.

SouthBoundingCoordinate 30.

The StructMetadata.0 global attribute (Table 12) is used by the HDF-EOS toolkit to
create the mapping relationships between the defined grid and data (SDSs).


Table 12. Listing of objects in the global attribute StructMetadata.0 in MOD11A1.

Object Definition
DIMENSION_1 XDim = 1200

DIMENSION_2 YDim = 1200

DataField_1 DataFieldName=LST_Day_1km
DataField_2 DataFieldName=QC_Day

DataField_3 DataFieldName=Day_view_time

DataField_4 DataFieldName=Day_view_angle
DataField_5 DataFieldName=LST_Night_1km

DataField_6 DataFieldName=QC_Night

DataField_7 DataFieldName=Night_view_time
DataField_8 DataFieldName=Night_view_angle

DataField_9 DataFieldName=Emis_31

DataField_ 10 DataFieldName=Emis_32
DataField_11 DataFieldName=Clear_day_cov

DataField_12 DataFieldName=Clear_night_cov

##### 3.5. Quality Assurance

The bit flags defined for the quality assurance SDSs QC_day and QC_Night are listed in
Table 1 3.

Table 13. Bit flags defined for SDSs QC_day and QC_Night in MOD11A1. Note that bit 0 is the
least significant bit.

```
bits Long Name Key
```
1 & 0 Mandatory QA flags

```
00=LST produced, good quality, not necessary to examine
more detailed QA
01=LST produced, other quality, recommend examination of
more detailed QA
10=LST not produced due to cloud effects
11=LST not produced primarily due to reasons other than cloud
```
3 & 2 Data quality flag

```
00=good data quality
01=other quality data
10=TBD
11=TBD
```
5 & 4 Emis Error flag

```
00=average emissivity error <= 0.01
01=average emissivity error <= 0.02
10=average emissivity error <= 0.04
11=average emissivity error > 0.04
```
7 & 6 LST LST Error flag

```
00=average LST error <= 1K
01=average LST error <= 2K
10=average LST error <= 3K
11=average LST error > 3K
```

#### 4. MOD11A2 Eight-day LST

An eight-day compositing period was chosen because twice of such period is the exact
ground track repeat period of the Terra platform. LST over eight days is the averaged
LSTs of the MOD11A1 product over eight days.

##### 4.1. Algorithm Description

A simple average method is used in the current algorithm for the MOD11A2 product.

##### 4.2. Scientific Data Sets

In the C6 MOD11A2 product, the first ten SDSs are similar to those in the MOD11A1
product described in Table 9. The last two SDSs, Clear_sky_days and Clear_sky_nights,
are similar to those in the 8-day CMG product described in Table 17.

##### 4.3. Local Attributes

Similar to MOD11A1.

##### 4.4. Global Attributes

Similar to MOD11A1.

##### 4.5. Quality Assurance

Similar to MOD11A1.

#### 5. MOD11B1 Daily LST

The C6 daily level 3 LST product at 6km spatial resolution is a tile of daily LST product
gridded in the Sinusoidal projection. A tile contains 200 x 200 grids in 200 rows and 20 0
columns. The exact grid size at the 6km spatial resolution is 5.56km by 5.56km.

##### 5.1. Algorithm Description

The daily MOD11B1 LST product is constructed with the results produced by the
day/night LST algorithm (Wan and Li, 1997) from pairs of daytime and nighttime
observations in seven MODIS TIR bands (bands 20, 22, 23, 29, and 31- 33 ). New
refinements implemented in the C6 LST processing include: (1) the new sets of split-
window algorithm coefficients are also incorporated into the day/night algorithm in order
to improve the LST and emissivity retrieval for bare soil grids in HAWBSZ within
latitude range from −38° to 49.5°. (2) the retrieved emissivity values in the view angle
bins for the current day's daytime and nighttime observations are separately outputted to
the level-3 M*D11B1 product for bands 20, 22, 23 and 29, in order to preserve the
viewing angle dependence in emissivity values in these bands. Usually the viewing
angles of MODIS daytime and nighttime observations in the same day are quite different
at a given location (Wan, 2014).


The constraints on the day/night LST algorithm include: (1) the day observations with
solar zenith angle not larger than 75 degrees; (2) the night observations with solar zenith
angle larger than 90 degrees (i.e., no solar radiation in the night observations); (3) the
time difference between the day and night observations cannot be longer than 32 days;
(4) brightness temperature Tb31 (daytime) >= 198K and Tb31(nighttime) >= 195K
because the signal-to-noise of TIR data in MWIR band 20 (which is used in the day/night
algorithm) becomes very small at low temperatures. These constraints significantly limit
the LST/emissivity retrieval in the polar region. Because a 12-bit linear quantization is
used for all MODIS TIR bands, MWIR bands 20 and 22 may saturate at hot spots during
the daytime in arid and semi-arid regions in the summer. The day/night LST algorithm
cannot be used in saturation cases due to lack of valid daytime data in bands 20 or 22.

##### 5.2. Scientific Data Sets (SDS)

The SDSs in the MOD11B1 product include LST_Day_6km, QC_Day, Day_view_time,
Day_view_angl, LST_Night_6km, QC_Night, Night_view_time, Night_view_angl,
Emis_20, Emis_22, Emis_23, Emis_29, Emis_31, Emis_32, Emis_20_night,
Emis_22_night, Emis_23_night, Emis_29_night, LST_Day_6km_Aggregated_from_1km
and LST_Night_6km_Aggregated_from_1km, QC_Emis, QC_Emis_night,
Percent_land_in_grid. The two SDSs Aggregated_from_1km are the daytime and
nighttime LSTs generated from the level-2 MOD11_L2 product through the 1-km band
31 radiance values aggregated to the 6km grids. They can be used to supplement
LST_Day_6km and LST_Night_6km, and for global browse imagery. The retrieved
emissivity values in the view angle bins for the current day's daytime and nighttime
observations are separately outputted to the daily MOD11B1 product for bands 20, 22, 23
and 29, in order to preserve the viewing angle dependence in emissivity values in these
bands. Usually the viewing angles of MODIS daytime and nighttime observations in the
same day are quite different at a given location (Wan, 2014). Their details are shown in
Table 1 4.

Table 14. The SDSs in the MOD11B1 product.

#### SDS

```
Name
```
#### Long

```
Name
```
#### Number

```
Type Unit^
```
#### Valid

```
Range
```
#### Fill

```
Value
```
#### scale

```
factor
```
#### add

```
offset
```
```
LST_Day_5km
```
```
Daily daytime 6km
```
#### grid

```
Land-surface
Temperature
```
```
uint16 K 750065535 - 0 0.02 0.0
```
```
QC_Day
```
```
Quality control for
daytime
LST and emissivity
```
```
uint 8 none 0 - 255 0 NA NA
```
```
Day_view_time
```
```
(local solar) Time of
daytime Land-
surface
Temperature
observation
```
```
uint8 hrs 0 - 120 0 0.2 0
```
```
* Day_view_angle
```
```
View zenith angle of
daytime
Land-surface
```
```
uint8 deg 0 - 130 255 1.0 - 65.0
```

```
Temperature
```
```
LST_Night_5km
```
```
Daily nighttime 6km
grid
Land-surface
Temperature
```
```
uint16 K 750065535 - 0 0.02 0.0
```
```
QC_Night
```
```
Quality control for
nighttime
LST and emissivity
```
```
uint8 none 0 - 255 0 NA NA
```
```
Night_view_time
```
```
(local solar) Time of
nighttime Land-
surface
Temperature
observation
```
```
uint8 hrs 0 - 120 0 0.2 0
```
```
* Night_view_angle
```
```
View zenith angle of
nighttime
Land-surface
Temperature
```
```
uint8 deg 0 - 130 255 1.0 - 65.0
```
```
Emis_20 Band 20 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_22 Band 22 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_23 Band 23 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_29 Band 29 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_31 Band 31 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_32 Band 32 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_20_night Band 20 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_22_night Band 22 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_23_night Band 23 emissivity uint8 none 1 - 255 0 0.002 0.49
```
```
Emis_29_night Band 29 emissivity uint8 none 1 - 255 0 0.002
0.49
```
(^49)
QC_Emis Quality control Emis uint8 none 0 - 255 0 NA NA
QC_Emis_night Quality control Emis uint8 none 0 - 255 0 NA NA
Percent_land_in_grid Percentage of Land in the Grid uint8 none 0 - 100 0 1.0 0
Note: * a negative sign before the zenith view angle indicates that the MODIS views the
Earth surface from east.
** The 03 - 00 four bits are for view angle flag of the companion observation (which is
night observation if LST_Day_6km valid, or day observation otherwise), with key 0- 15
as index of view angle sub-range of the companion observation: 0-7 if view from east (0
at the west end of scan line); 8-15 if view from west (15 at the east end of scan line). The
06 - 04 three bits are used for a flag of time difference between the day and night MODIS
observations, with key 0-7 as couples of days, 7 representing the range from 7 to 16 (i.e.,
14 - 32 days). Bit 07 is for DEM slope flag, with key 0=DEM slope not considered or
1=DEM slope considered in the day/night algorithm. There are eight view angle sub-
ranges in the whole range of viewing zenith angle at the surface from 0- 65 o and they are
0 - 10, 10 - 20, 20-30, 30-39, 39-47, 47-54, 54-60, and 60-65 degrees.


##### 5.3. Local Attributes

The local attributes for SDSs LST_Day_6km and LST_Night_6km are similar to those in
Table 5.

##### 5.4. Global Attributes

Three ECS global attributes and 16 product-specific global attributes are stored as
metadata. The ECS global attributes, CoreMetadata.0, ArchiveMetadata.0 and
StructMetadata.0 are stored as very long character strings in PVL format.

CoreMetadata.0 contains information about the product during production and is used to
populate the EOSDIS data base for user support. They are similar to those of MOD11A1.

##### 5.5. Quality Assurance

The bit flags defined for the quality assurance SDSs QC_day and QC_Night in
MOD11B1 are listed in Table 1 5.

Table 15. Bit flags defined for SDSs QC_day and QC_Night in MOD11B1. Note that bit 0 is the
least significant bit.

```
bits Long Name Key
```
1 & 0 Mandatory QA flags

#### 00=LST produced, good quality, not necessary to examine

#### more detailed QA

#### 01=LST produced, other quality, recommend examination of

#### more detailed QA

#### 10=LST not produced due to cloud effects

```
11=LST not produced primarily due to reasons other than cloud
```
#### 2 Data quality flag 0=1=other qgood^ data qualityuality data^

3 Terra/AquaCombined-use flag^ 0=1=yesno^

5 & 4 Emis Error flag

#### 00=average emissivity error <= 0.01

#### 01=average emissivity error <= 0.02

#### 10=average emissivity error <= 0.04

```
11=average emissivity error > 0.04
```
7 & 6 LST LST Error flag

#### 00=average LST error <= 1K

#### 01=average LST error <= 2K

#### 10=average LST error <= 3K

```
11=average LST error > 3K
```
#### 6. MOD11B2 8-Day LST

The C6 8-day level 3 LST product at 6km spatial resolution is the average LST product
of the daily LST product over the period of eight days.


##### 6.1. Algorithm Description

The simple average and composite method is used to average the valid LST and
emissivity values in the MOD11B1 product over the 8-day period. The 8-day period does
not across the end of the data year.

##### 6 .2. Scientific Data Sets (SDS)

The SDSs in the MOD11B2 product include LST_Day_6km, QC_Day, Day_view_time,
Day_view_angl, LST_Night_6km, QC_Night, Night_view_time, Night_view_angl,
Emis_20, Emis_22, Emis_23, Emis_29, Emis_31, Emis_32, Percent_land_in_grid,
LST_Day_6km_Aggregated_from_1km and LST_Night_6km_Aggregated_from_1km,.
Clear_sky_days, Clear_sky_nights, and Percent_land_in_grid. Their details are shown in
Table 1 6.

Table 16. The SDSs in the MOD11B2 product.

#### SDS

```
Name
```
#### Long

```
Name
```
#### Number

```
Type Unit^
```
#### Valid

```
Range
```
#### Fill

```
Value
```
#### scale

```
factor
```
#### add

```
offset
```
```
LST_Day_6km
```
```
Daily daytime 6km
```
#### grid

```
Land-surface
Temperature
```
```
uint16 K 655357500 - 0 0.02 0.0
```
```
QC_Day
```
```
Quality control for
daytime
LST and emissivity
```
```
uint8 none 0 - 255 0 NA NA
```
```
Day_view_time
```
```
(local solar) Time of
daytime Land-surface
Temperature
observation
```
```
uint8 hrs 0 - 120 0 0.2 0
```
```
* Day_view_angle
```
```
View zenith angle of
daytime
Land-surface
Temperature
```
```
uint8 deg 0 - 130 255 1.0 - 65.0
```
```
LST_Night_6km
```
```
Daily nighttime 6km
grid
Land-surface
Temperature
```
```
uint16 K 655357500 - 0 0.02 0.0
```
```
QC_Night
```
```
Quality control for
nighttime
LST and emissivity
```
```
uint8 none 0 - 255 0 NA NA
```
```
Night_view_time
```
```
(local solar) Time of
nighttime Land-
surface
Temperature
observation
```
```
uint8 hrs 0 - 120 0 0.2 0
```
```
* Night_view_angle
```
```
View zenith angle of
nighttime
Land-surface
Temperature
```
```
uint8 deg 0 - 130 255 1.0 - 65.0
```

```
Emis_2 0 Band 20 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_22 Band 22 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_23 Band 23 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_29 Band 29 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_31 Band 31 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_32 Band 32 emissivity uint8 none 1 - 255 0 0.002 0.49
```
```
LST_Day_6km_Aggregated_from_1km
```
```
Daily daytime 6km
grid LST aggregated
from 1km
```
```
uint16 K 655357500 - 0 0.02 0.
```
LST_Night_6km_Aggregated_from_1km

```
Daily nighttime 6km
grid LST aggregated
from 1km
```
```
uint16 K 655357500 - 0 0.02 0.
```
```
Clear_sky_days Days in clearconditions - sky
uint8 none 0 - 255 0 na na
Clear_sky_nights Nights in clearconditions - sky
```
```
Percent_land_in_grid Percentage of Land in the Grid uint8 none 0 - 100 0 1.0 0
```
##### 6.3. Local Attributes

Similar to those in MOD11B1.

##### 6.4. Global Attributes

#### Similar to those in MOD11B1.

##### 6.5. Quality Assurance

Similar to those in MOD11B1.

#### 7. MOD11B3 MONTHLY LST

The C6 monthly level 3 LST product at 6km spatial resolution is the average LST
product of the daily LST product over one month.

##### 7 .1. Algorithm Description

The simple average and composite method is used to average the valid LST and
emissivity values in the MOD11B1 product over one month.

##### 7 .2. Scientific Data Sets (SDS)

The SDSs in the MOD11B3 product are similar to those in Table 16.

##### 7.3. Local Attributes

Similar to those in MOD11B1.


##### 7.4. Global Attributes

#### Similar to those in MOD11B1.

##### 7.5. Quality Assurance

Similar to those in MOD11B1.

#### 8. MOD11C1 Daily CMG LST

This daily global LST product provides temperature and emissivity values at 0.05 degree
latitude/longitude climate model grids (CMG). The exact areal size of the equal angle
grids varies with latitude, and it is 5.6km by 5.6km at the Equator.

##### 8 .1. Algorithm Description

The temperature and emissivity values in MOD11C1 are derived by reprojection and
average of the values in the daily MODIS LST/E product (MOD11B1) at 6km equal area
grids in the sinusoidal projection. The LST values aggregated to 6km grids from those
retrieved by the generalized split-window algorithm are used to supplement the LSTs
retrieved by the day/night LST algorithm at grids where there is no valid pair of day and
night observations (usually in high-latitude regions). Due to this LST supplement, the
spatial coverages of LSTs are larger than the spatial coverage of retrieved emissivities in
the MOD11C products.

##### 8 .2. Scientific Data Sets (SDS)

There are 16 SDSs in the MOD11C1 product. They are similar to those in the MOD11B1
product as shown in Table 1 4 , except changing LST_Day_6km to LST_Day_CMG and
LST_Night_6km to LST_Night_CMG, and without
LST_Day_6km_Aggregated_from_1km and LST_Night _6km_Aggregated_from_1km.

##### 8 .3. Local Attributes

The local attributes for SDSs LST_Day_CMG and LST_Night_CMG are similar to those
in Table 4.

##### 8 .4. Global Attributes

Three ECS global attributes and 16 product-specific global attributes are stored as
metadata. The ECS global attributes, CoreMetadata.0, ArchiveMetadata.0 and
StructMetadata.0 are stored as very long character strings in PVL format.

CoreMetadata.0 contains information about the product during production and is used to
populate the EOSDIS data base for user support. They are similar to those of MOD11A1.

##### 8 .5. Quality Assurance

The bit flags in the QC SDS are similar to those in Table 15.


#### 9. MOD11C2 8-Day CMG LST

This LST product provides 8-day composited and averaged temperature and emissivity
values at 0.05 degree latitude/longitude grids (CMG), as well as the averaged observation
times and viewing zenith angles for daytime and nighttime LSTs.

##### 9 .1. Algorithm Description

The temperature and emissivity values in the MOD11C1 product over a period of 8 days
are simply composited and averaged. The days and nights in clear-sky conditions and
with validated LSTs are flagged in each bit of two 8 - bit unsigned integers (one for
daytime LSTs and another for nighttime LSTs).

##### 9 .2. Scientific Data Sets (SDS)

There are 17 SDSs in the MOD11C2 product as shown in Table 17.

Table 17. The SDSs in the MOD11C2 product.

#### SDS

```
Name
```
#### Long

```
Name
```
#### Number

```
Type Unit^
```
#### Valid

```
Range
```
#### Fill

```
Value
```
#### scale

```
factor
```
#### add

```
offset
```
LST_Day_CMG (^8) Land-day-^ surface Temperaturedaytime 3min CMG^ uint16 K 750065535 - 0 0.02 0.0

#### QC_Day Quality control for daytimeLST and emissivity uint8 none 0 - 255 0 NA NA

```
Day_view_time
```
```
Averaged time of daytime
```
#### LST

```
observation (UTC)
```
```
uint8 hrs 0 - 120 0 0.2 0
```
```
Day_view_angle
```
#### Averaged view zenith angle of

#### daytime

```
Land-surface Temperature
```
```
uint8 deg 0 - 130 255 1.0 - 65.0
```
#### * Clear_sky_days the days in clearand with validate LSTs-sky conditions uint8 none 0 - 255 0 na na

LST_Night_CMG (^8) Land-day-^ surface Temperaturenighttime 3min CMG uint16 K 750065535 - 0 0.02 0.0

#### QC_Night Quality control for nighttimeLST and emissivity uint8 none 0 - 255 0 NA NA

```
Night_view_time
```
```
Averaged time of nighttime
```
#### LST

```
observation (UTC)
```
```
uint8 hrs 0 - 120 0 0.2 0
```
#### Night_view_angle Averaged view zenith angle of nighttimeLand-surface Temperature uint8 deg 0 - 130 255 1.0 - 65.0

#### * Clear_sky_nights the nights in clearand with validate LSTs-sky conditions uint8 none 0 - 255 0 na na

```
Emis_20 Band 20 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_22 Band 22 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_23 Band 23 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_29 Band 29 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_31 Band 31 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_32 Band 32 emissivity uint8 none 1 - 255 0 0.002 0.49
```

Percent_land_in_grid Percentage of Land in the Grid uint8 none 0 - 100 0 1.0 0

* Each bit in the 8-bit unsigned integer indicates clear-sky (1) or not (0) in the
corresponding day or night. Bit 00 is for the first day or night, and bit 07 is for the last
day or night in the 8-day period.

##### 9 .3. Local Attributes

The local attributes for SDSs LST_Day_CMG and LST_Night_CMG are similar to those
in Table 5.

##### 9 .4. Global Attributes

Three ECS global attributes and 16 product-specific global attributes are stored as
metadata. The ECS global attributes, CoreMetadata.0, ArchiveMetadata.0 and
StructMetadata.0 are stored as very long character strings in PVL format.

CoreMetadata.0 contains information about the product during production and is used to
populate the EOSDIS data base for user support. They are similar to those of MOD11A1.

##### 9 .5. Quality Assurance

The bit flags in the QC SDS are similar to those in Table 15.

#### 10. MOD11C3 Monthly CMG LST

This LST product provides monthly composited and averaged temperature and emissivity
values at 0.05 degree latitude/longitude grids (CMG), as well as the averaged observation
times and viewing zenith angles for daytime and nighttime LSTs.

##### 10 .1. Algorithm Description

The temperature and emissivity values in the MOD11C1 product in a calendar month are
simply composited and averaged. The days and nights in clear-sky conditions and with
validated LSTs are flagged in each bit of two 32 - bit unsigned integers (one for daytime
LSTs and another for nighttime LSTs).

##### 10 .2. Scientific Data Sets (SDS)

There are 17 SDSs in the MOD11C3 product as shown in Table 18.


Table 18. The SDSs in the MOD11C3 product.

#### SDS

```
Name
```
#### Long

```
Name
```
#### Number

```
Type Unit^
```
#### Valid

```
Range
```
#### Fill

```
Value
```
#### scale

```
factor
```
#### add

```
offset
```
#### LST_Day_CMG Monthly daytime 3min CMGLand-surface Temperature uint16 K 7500 - 65535 0 0.02 0.0

#### QC_Day Quality control for daytimeLST and emissivity uint8 none 0 - 255 0 NA NA

```
Day_view_time
```
```
Averaged time of daytime
```
#### LST

```
observation (UTC)
```
```
uint8 hrs 0 - 120 0 0.2 0
```
```
Day_view_angle
```
#### Averaged view zenith angle

#### of daytime

```
Land-surface Temperature
```
```
uint8 deg 0 - 130 255 1.0 - 65.0
```
#### Clear_sky_days the days in clearand with validate LSTs-sky conditions uint32 none 42949672960 - 0 na na

#### LST_Night_CMG Monthly nighttime 3min CMGLand-surface Temperature uint16 K 7500 - 65535 0 0.02 0.0

#### QC_Night Quality control for nighttimeLST and emissivity uint8 none 0 - 255 0 NA NA

#### Night_view_time Averaged time of nighttime LSTobservation (UTC) uint8 hrs 0 - 120 0 0.2 0

```
Night_view_angle
```
```
Averaged view zenith angle of
```
#### nighttime

```
Land-surface Temperature
```
```
uint8 deg 0 - 130 255 1.0 - 65.0
```
#### Clear_sky_nights the nights in clearand with validate LSTs-sky conditions uint32 none 42949672960 - 0 na na

Emis_20 Band 20 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_22 Band 22 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_23 Band 23 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_29 Band 29 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_31 Band 31 emissivity uint8 none 1 - 255 0 0.002 0.49
Emis_32 Band 32 emissivity uint8 none 1 - 255 0 0.002 0.49
Percent_land_in_grid Percentage of Land in the Grid uint8 none 0 - 100 0 1.0 0

##### 10 .3. Local Attributes

The local attributes for SDSs LST_Day_CMG and LST_Night_CMG are similar to those
in Table 5.

##### 10 .4. Global Attributes

Three ECS global attributes and 16 product-specific global attributes are stored as
metadata. The ECS global attributes, CoreMetadata.0, ArchiveMetadata.0 and
StructMetadata.0 are stored as very long character strings in PVL format.

CoreMetadata.0 contains information about the product during production and is used to
populate the EOSDIS data base for user support. They are similar to those of MOD11A1.


##### 10 .5. Quality Assurance

The bit flags in the QC SDS are similar to those in Table 1 5.

#### 11. Publications and References

Z. Wan and J. Dozier, 1996, "A generalized split-window algorithm for retrieving land-
surface temperature from space", IEEE Trans. Geosci. Remote Sens., v34, n4, pp. 892-
905.

Z. Wan and Z.-L. Li, 1997, "A physics-based algorithm for retrieving land-surface
emissivity and temperature from EOS/MODIS data", IEEE Trans. Geosci. Remote Sens.,
v35, n4, pp. 980-996.

W. C. Snyder, Z. Wan, Y. Zhang and Y.-Z. Feng, 1998, "Classification-based emissivity
for land surface temperature measurement from space", Int. J. Remote Sens., v19, n14,
pp. 2753-2774.

W. C. Snyder and Z. Wan, 1998, "BRDF models to predict spectral reflectance and
emissivity in the thermal infrared", IEEE Trans. Geosci. Remote Sens., v36, n1, pp. 214-
225.

Z. Wan, Y. Zhang, X. Ma, M. D. King, J. S. Myers, and X. Li, 1999, "Vicarious
calibration of the Moderate-Resolution Imaging Spectroradiometer Airborn Simulator
thermal infrared channels", Appl. Optics, v38, n20, pp. 6294-6306.

Z. Wan, 2002, "Estimate of noise and systematic error in early thermal infrared data of
the Moderate Resolution Imaging Spectroradiometer (MODIS)", Remote Sens. Environ.,
80, 47-54.

Z. Wan, Y. Zhang, Z.-L. Li, R. Wang, V.V. Salomonson, A. Yves, R. Bosseno, and J. F.
Hanocq, 2002, "Preliminary estimate of calibration of the Moderate Resolution Imaging
Spectroradiometer (MODIS) thermal infrared data using Lake Titicaca", Remote Sens.
Environ., 80, 497-515.

Z. Wan, Y. Zhang, Q. Zhang, and Z.-L. Li, 2002, "Validation of the land-surface
temperature products retrieved from Terra Moderate Resolution Imaging
Spectroradiometer data", Remote Sens. Environ., 83, 163-180.

Z. Wan, Y. Zhang, Q. Zhang, and Z.-L. Li, 2004, "Quality assessment and validation of
the MODIS land surface temperature", Int. J. Remote Sens., 25, 261-274.

C, Coll, V. Caselles, J.M. Galve, E. Valor, R. Niclos, J.M. Sanchez, and R. Rivas, 2005,
"Ground measurements for the validation of land surface temperatures derived from
AATSR and MODIS data", Remote Sens. Environ., 97, 288-300.

Z. Wan, 2008, "New refinements and validation of the MODIS land-surface
temperature/emissivity products ", Remote Sens. Environ., 112, 59-74.


Z. Wan, 2014, "New refinements and validation of the Collection-6 MODIS land-surface
temperature/emissivity products ", Remote Sens. Environ., 140, 36-45.

Z. Wan, & Z.-L. Li, 2008, “Radiance-based validation of the V5 MODIS land-surface
temperature product”, International Journal of Remote Sensing, 29 , 5373–5393.

Z. Wan, & Z.-L. Li, 2011, Chapter 25, MODIS land surface temperature and emissivity.
In B. Ramachandran, C. O. Justice, & M. J. Abrams (Eds.), Land remote sensing and
global environmental change, NASA's Earth observing system and the science of ASTER
and MODIS, NASA's Earth observing system and the science of ASTER and MODIS.
New York Dordrecht Heidelberg London: Springer, [http://dx.doi.org/10.1007/978-](http://dx.doi.org/10.1007/978-) 1 -
4419 - 6749 - 7.

#### 12. Related Documents

Z. Wan, "MODIS Land-Surface Temperature Algorithm Theoretical Basis Document
(LST ATBD) Version 3.3, April 1999"

Wolfe, R.E., D.P. Roy, E. Vermote, 1998, "MODIS land data storage, gridding and
compositing methodology: level 2 grid", IEEE Trans. Geosci. Remote Sens., v36, n4, pp.
1324 - 1338.

Integerized Sinusoidal Projection

"The WMO Format for the Storage of Weather Product Information and the Exchange of
Weather Product Messages in Gridded Binary Form", John D. Stackpole, Office Note
388, GRIB Edition 1, U.S. Dept. of Commerce, NOAA, National Weather Service
National Meteorological Center, Automation Division, Section 1, pp. 9-12, July 1, 1994.

"The Michigan Earth Grid: Description, Registration Method for SSM/I Data, and
Derivative Map Projections", John F. Galntowicz, Anthony W. England, The University
of Michigan, Radiation Laborartory, Ann Arbor, Michigan, Feb. 1991.

"Selection of a Map Grid for Data Analysis and Archival", William B. Rossow, and
Leonid Garder, American Meteorological Society Notes, pp. 1253-1257, Aug. 1984.

"Level-3 SeaWiFS Data Products: Spatial and Temporal Binning Algorithms", Janet W.
Campbell, John M. Blaisdell, and Michael Darzi, NASA Technical Memorandum
104566, GSFC, Volume 32, Appendix A, Jan. 13, 1995.

"Key Characteristics of MODIS Data Products", E. Masuoka, A. Fleig, Robert E. Wolfe
and F. Patt, IEE Transactions on Geoscience and Remote Sensing, Vol 36(4), 1313-1323,
July 1998.


